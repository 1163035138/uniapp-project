{"code":"import { defineComponent } from \"vue\";\nimport { props } from './props';\nimport { mpMixin } from '../../libs/mixin/mpMixin';\nimport { mixin } from '../../libs/mixin/mixin';\nimport { addUnit, addStyle, deepMerge } from '../../libs/function/index';\n/**\n * Image 图片\n * @description 此组件为uni-app的image组件的加强版，在继承了原有功能外，还支持淡入动画、加载中、加载失败提示、圆角值和形状等。\n * @tutorial https://uview-plus.jiangruyi.com/components/image.html\n * @property {String}\t\t\tsrc \t\t\t\t图片地址\n * @property {String}\t\t\tmode \t\t\t\t裁剪模式，见官网说明 （默认 'aspectFill' ）\n * @property {String | Number}\twidth \t\t\t\t宽度，单位任意，如果为数值，则为px单位 （默认 '300' ）\n * @property {String | Number}\theight \t\t\t\t高度，单位任意，如果为数值，则为px单位 （默认 '225' ）\n * @property {String}\t\t\tshape \t\t\t\t图片形状，circle-圆形，square-方形 （默认 'square' ）\n * @property {String | Number}\tradius\t\t \t\t圆角值，单位任意，如果为数值，则为px单位 （默认 0 ）\n * @property {Boolean}\t\t\tlazyLoad\t\t\t是否懒加载，仅微信小程序、App、百度小程序、字节跳动小程序有效 （默认 true ）\n * @property {Boolean}\t\t\tshowMenuByLongpress\t是否开启长按图片显示识别小程序码菜单，仅微信小程序有效 （默认 true ）\n * @property {String}\t\t\tloadingIcon \t\t加载中的图标，或者小图片 （默认 'photo' ）\n * @property {String}\t\t\terrorIcon \t\t\t加载失败的图标，或者小图片 （默认 'error-circle' ）\n * @property {Boolean}\t\t\tshowLoading \t\t是否显示加载中的图标或者自定义的slot （默认 true ）\n * @property {Boolean}\t\t\tshowError \t\t\t是否显示加载错误的图标或者自定义的slot （默认 true ）\n * @property {Boolean}\t\t\tfade \t\t\t\t是否需要淡入效果 （默认 true ）\n * @property {Boolean}\t\t\twebp \t\t\t\t只支持网络资源，只对微信小程序有效 （默认 false ）\n * @property {String | Number}\tduration \t\t\t搭配fade参数的过渡时间，单位ms （默认 500 ）\n * @property {String}\t\t\tbgColor \t\t\t背景颜色，用于深色页面加载图片时，为了和背景色融合  (默认 '#f3f4f6' )\n * @property {Object}\t\t\tcustomStyle  \t\t定义需要用到的外部样式\n * @event {Function}\tclick\t点击图片时触发\n * @event {Function}\terror\t图片加载失败时触发\n * @event {Function} load 图片加载成功时触发\n * @example <u-image width=\"100%\" height=\"300px\" :src=\"src\"></u-image>\n */\nexport default defineComponent({\n    name: 'u-image',\n    mixins: [mpMixin, mixin, props],\n    data() {\n        return {\n            // 图片是否加载错误，如果是，则显示错误占位图\n            isError: false,\n            // 初始化组件时，默认为加载中状态\n            loading: true,\n            // 不透明度，为了实现淡入淡出的效果\n            opacity: 1,\n            // 过渡时间，因为props的值无法修改，故需要一个中间值\n            durationTime: this.duration,\n            // 图片加载完成时，去掉背景颜色，因为如果是png图片，就会显示灰色的背景\n            backgroundStyle: new UTSJSONObject({}),\n            // 用于fade模式的控制组件显示与否\n            show: false\n        };\n    },\n    watch: {\n        src: {\n            immediate: true,\n            handler(n = null) {\n                if (!n) {\n                    // 如果传入null或者''，或者false，或者undefined，标记为错误状态\n                    this.isError = true;\n                }\n                else {\n                    this.isError = false;\n                    this.loading = true;\n                }\n            }\n        }\n    },\n    computed: {\n        transStyle() {\n            let style = new UTSJSONObject({});\n            // 通过调用addUnit()方法，如果有单位，如百分比，px单位等，直接返回，如果是纯粹的数值，则加上rpx单位\n            if (this.loading || this.isError || this.width == '100%' || this.mode != 'heightFix') {\n                style.width = addUnit(this.width);\n            }\n            else {\n                style.width = 'fit-content';\n            }\n            if (this.loading || this.isError || this.height == '100%' || this.mode != 'widthFix') {\n                style.height = addUnit(this.height);\n            }\n            else {\n                style.height = 'fit-content';\n            }\n            return style;\n        },\n        wrapStyle() {\n            let style = new UTSJSONObject({});\n            // 通过调用addUnit()方法，如果有单位，如百分比，px单位等，直接返回，如果是纯粹的数值，则加上rpx单位\n            if (this.loading || this.isError || this.width == '100%' || this.mode != 'heightFix') {\n                style.width = addUnit(this.width);\n            }\n            else {\n                style.width = 'fit-content';\n            }\n            if (this.loading || this.isError || this.height == '100%' || this.mode != 'widthFix') {\n                style.height = addUnit(this.height);\n            }\n            else {\n                style.height = 'fit-content';\n            }\n            // 如果是显示圆形，设置一个很多的半径值即可\n            style.borderRadius = this.shape == 'circle' ? '10000px' : addUnit(this.radius);\n            // 如果设置圆角，必须要有hidden，否则可能圆角无效\n            style.overflow = this.radius > 0 ? 'hidden' : 'visible';\n            // if (this.fade) {\n            // \tstyle.opacity = this.opacity\n            // \t// nvue下，这几个属性必须要分开写\n            // \tstyle.transitionDuration = `${this.durationTime}ms`\n            // \tstyle.transitionTimingFunction = 'ease-in-out'\n            // \tstyle.transitionProperty = 'opacity'\n            // }\n            return deepMerge(style, addStyle(this.customStyle));\n        }\n    },\n    mounted() {\n        this.show = true;\n    },\n    emits: ['click', 'error', 'load'],\n    methods: {\n        addUnit,\n        // 点击图片\n        onClick(e = null) {\n            this.$emit('click', e);\n        },\n        // 图片加载失败\n        onErrorHandler(err = null) {\n            this.loading = false;\n            this.isError = true;\n            this.$emit('error', err);\n        },\n        // 图片加载完成，标记loading结束\n        onLoadHandler(event = null) {\n            this.loading = false;\n            this.isError = false;\n            this.$emit('load', event);\n            this.removeBgColor();\n            // 如果不需要动画效果，就不执行下方代码，同时移除加载时的背景颜色\n            // 否则无需fade效果时，png图片依然能看到下方的背景色\n            // if (!this.fade) return this.removeBgColor();\n            // // 原来opacity为1(不透明，是为了显示占位图)，改成0(透明，意味着该元素显示的是背景颜色，默认的灰色)，再改成1，是为了获得过渡效果\n            // this.opacity = 0;\n            // // 这里设置为0，是为了图片展示到背景全透明这个过程时间为0，延时之后延时之后重新设置为duration，是为了获得背景透明(灰色)\n            // // 到图片展示的过程中的淡入效果\n            // this.durationTime = 0;\n            // // 延时50ms，否则在浏览器H5，过渡效果无效\n            // setTimeout(() => {\n            // \tthis.durationTime = this.duration;\n            // \tthis.opacity = 1;\n            // \tsetTimeout(() => {\n            // \t\tthis.removeBgColor();\n            // \t}, this.durationTime);\n            // }, 50);\n        },\n        // 移除图片的背景色\n        removeBgColor() {\n            // 淡入动画过渡完成后，将背景设置为透明色，否则png图片会看到灰色的背景\n            // this.backgroundStyle = {\n            // \tbackgroundColor: this.bgColor || '#ffffff'\n            // };\n        }\n    }\n});\n//# sourceMappingURL=C:/Users/86150/Desktop/%E5%BC%A0%E4%BA%9A%E5%86%AC%E9%A1%B9%E7%9B%AE/uniapp-project/uni_modules/uview-plus/components/u-image/u-image.vue?vue&type=script&lang.uts.js.map","references":["C:/Users/86150/Desktop/张亚冬项目/uniapp-project/uni_modules/uview-plus/components/u-image/props.js","C:/Users/86150/Desktop/张亚冬项目/uniapp-project/uni_modules/uview-plus/libs/mixin/mpMixin.js","C:/Users/86150/Desktop/张亚冬项目/uniapp-project/uni_modules/uview-plus/libs/mixin/mixin.js","C:/Users/86150/Desktop/张亚冬项目/uniapp-project/uni_modules/uview-plus/libs/function/index.js"],"uniExtApis":[],"map":"{\"version\":3,\"file\":\"u-image.vue?vue&type=script&lang.uts.js\",\"sourceRoot\":\"\",\"sources\":[\"u-image.vue?vue&type=script&lang.uts\"],\"names\":[],\"mappings\":\"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\"}"}
