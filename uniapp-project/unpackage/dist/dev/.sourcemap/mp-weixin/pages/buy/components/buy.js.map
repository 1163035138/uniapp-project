{"version":3,"file":"buy.js","sources":["pages/buy/components/buy.uvue","D:/HBuilderX/plugins/uniapp-cli-vite/uniComponent:/QzovVXNlcnMvODYxNTAvRGVza3RvcC_lvKDkuprlhqzpobnnm64vdW5pYXBwLXByb2plY3QvcGFnZXMvYnV5L2NvbXBvbmVudHMvYnV5LnV2dWU"],"sourcesContent":["<template>\r\n\t<view class=\"home\">\r\n\t\t<div class=\"sticky\">\r\n\t\t\t<up-search v-model=\"searchValue\" :show-action=\"false\" shape=\"square\" @blur=\"fetchFlowData\"></up-search>\r\n\t\t\t<up-tabs :list=\"list1\" :active-color=\"'#0AB7B8'\" v-if=\"list1.length\" itemStyle=\"\" @change=\"tabsClick\"\r\n\t\t\t\t:current=\"tabCurrent\"></up-tabs>\r\n\t\t</div>\r\n\t\t<div class=\"waterfall\">\r\n\t\t\t<swiper :current=\"swiperCurrent\" class=\"swiper\" @change=\"changeSwiper\" >\r\n\t\t\t\t<swiper-item v-for=\"(item, index) in list1\" :key=\"index\" :item-id=\"index.toString()\"\r\n\t\t\t\t\tclass=\"swiper-item\">\r\n\t\t\t\t\t<scroll-view scroll-y style=\"height:100%;width: 100%\" @scrolltolower=\"scrolltolower\" :lower-threshold=\"400\">\r\n\t\t\t\t\t\t<up-waterfall v-model=\"flowList\">\r\n\t\t\t\t\t\t\t<template v-slot:left=\"{leftList}\">\r\n\t\t\t\t\t\t\t\t<view v-if=\"tabCurrent === index\">\r\n\t\t\t\t\t\t\t\t\t<view v-for=\"(item1, index1) in leftList\" :key=\"index1\">\r\n\t\t\t\t\t\t\t\t\t\t<view class=\"waterfall-item\">\r\n\t\t\t\t\t\t\t\t\t\t\t<up-lazy-load threshold=\"0\" border-radius=\"10\" :image=\"item1.photos?.[0]\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t:index=\"index1+'left'\" height='600rpx'\r\n\t\t\t\t\t\t\t\t\t\t\t\timg-mode=\"aspectFill\"></up-lazy-load>\r\n\t\t\t\t\t\t\t\t\t\t\t<view class=\"content\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"title\">{{ item1.title }}</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"content-bottom\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"content-bottom-left\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<up-image :src=\"item1.avatar\" width='30rpx' height='30rpx'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tshape=\"circle\"></up-image>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"nickname\">{{ item1.nickname }}</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"content-bottom-right\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<up-icon name=\"thumb-up\" size=\"20\"></up-icon>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view>{{ item1.likes }}</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t\t<template v-slot:right=\"{rightList}\">\r\n\t\t\t\t\t\t\t\t<view v-if=\"tabCurrent === index\">\r\n\t\t\t\t\t\t\t\t\t<view v-for=\"(item2, index2) in rightList\" :key=\"index2\">\r\n\t\t\t\t\t\t\t\t\t\t<view class=\"waterfall-item\">\r\n\t\t\t\t\t\t\t\t\t\t\t<up-lazy-load threshold=\"0\" border-radius=\"10\" :image=\"item2.photos?.[0]\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t:index=\"index2+'right'\" height='600rpx'\r\n\t\t\t\t\t\t\t\t\t\t\t\timg-mode=\"aspectFill\"></up-lazy-load>\r\n\t\t\t\t\t\t\t\t\t\t\t<view class=\"content\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"title\">{{ item2.title }}</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"content-bottom\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"content-bottom-left\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<up-image :src=\"item2.avatar\" width='30rpx' height='30rpx'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tshape=\"circle\"></up-image>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"nickname\">{{ item2.nickname }}</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"content-bottom-right\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<up-icon name=\"thumb-up\" size=\"20\"></up-icon>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view>{{ item2.likes }}</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t</up-waterfall>\r\n\t\t\t\t\t\t<up-loadmore :status=\"loadStatus\" color=\"black\"\r\n\t\t\t\t\t\t\tstyle=\"overflow: unset;padding:10px 0 20px 0;margin:0\"></up-loadmore>\r\n\t\t\t\t\t</scroll-view>\r\n\t\t\t\t</swiper-item>\r\n\t\t\t</swiper>\r\n\t\t</div>\r\n\t</view>\r\n</template>\r\n\r\n<script setup lang=\"uts\">\r\n\timport { getHomeData, getHomeWaterfallData } from '../../index/api';\r\n\r\n\tconst searchValue = ref('');\r\n\tconst list1 = reactive([]);\r\n\tconst flowList = ref([]);\r\n\tconst loadStatus = ref('loadmore');\r\n\tconst tabCurrent = ref(0);\r\n\tconst swiperCurrent = ref(0);\r\n\tconst pagination = reactive({\r\n\t\tpage: 1,\r\n\t\tpageSize: 10,\r\n\t\ttotal: 0\r\n\t})\r\n\r\n\t//获取标签数据\r\n\tconst fetchTabsData = async () => {\r\n\t\ttry {\r\n\t\t\tconst res = await getHomeData();\r\n\t\t\tif (res?.errorCode === 200) {\r\n\t\t\t\tconst formattedData = res.data.map(item => ({ name: item.title, company: item.company }));\r\n\t\t\t\tlist1.splice(0, list1.length, ...formattedData);\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tuni.__f__('error','at pages/buy/components/buy.uvue:99','获取标签数据失败', error);\r\n\t\t}\r\n\t};\r\n\t//获取瀑布流数据\r\n\tconst fetchFlowData = async () => {\r\n\t\ttry {\r\n\t\t\tconst params = {\r\n\t\t\t\tpage: pagination.page,\r\n\t\t\t\tpageSize: pagination.pageSize,\r\n\t\t\t\tsearchValue: searchValue.value,\r\n\t\t\t\tcompany: list1[tabCurrent.value]?.company || ''\r\n\t\t\t}\r\n\t\t\tconst res = await getHomeWaterfallData(params);\r\n\t\t\tif (res?.errorCode === 200) {\r\n\t\t\t\tpagination.page = res.data.pagination.page;\r\n\t\t\t\tpagination.pageSize = res.data.pagination.pageSize;\r\n\t\t\t\tpagination.total = res.data.pagination.total;\r\n\t\t\t\t//判断是否还有数据\r\n\t\t\t\tif (res.data.pagination.page * res.data.pagination.pageSize >= res.data.pagination.total) {\r\n\t\t\t\t\tflowList.value = [...flowList.value, ...res.data.list];\r\n\t\t\t\t\tloadStatus.value = 'nomore';\r\n\t\t\t\t} else {\r\n\t\t\t\t\tflowList.value = [...flowList.value, ...res.data.list];\r\n\t\t\t\t\tloadStatus.value = 'loadmore';\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tuni.__f__('error','at pages/buy/components/buy.uvue:126','获取瀑布流数据失败', error);\r\n\t\t\tloadStatus.value = 'loadmore';\r\n\t\t} finally {\r\n\t\t\t// 请求完成后重置标志位\r\n\t\t}\r\n\t};\r\n\t//点击标签\r\n\tconst tabsClick = (item, index) => {\r\n\t\tswiperCurrent.value = index;\r\n\t}\r\n\tconst scrolltolower = () => {\r\n\t\tif (loadStatus.value === 'nomore') {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tpagination.page++;\r\n\t\tfetchFlowData();\r\n\t}\r\n\tconst changeSwiper = ({ detail: { current } }) => {\r\n\t\tflowList.value = [];\r\n\t\ttabCurrent.value = current;\r\n\t\tswiperCurrent.value = current;\r\n\t\tpagination.page = 1;\r\n\t\tfetchFlowData();\r\n\t}\r\n\tonMounted(() => {\r\n\t\t// 获取标签数据\r\n\t\tfetchTabsData();\r\n\t\t// 获取瀑布流数据\r\n\t\tfetchFlowData();\r\n\t});\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n\t.home {\r\n\t\theight: 100%;\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\r\n\t\t.sticky {\r\n\t\t\tposition: fixed;\r\n\t\t\ttop: 0;\r\n\t\t\tleft: 0;\r\n\t\t\tright: 0;\r\n\t\t\tz-index: 100;\r\n\t\t\tbackground-color: #fff;\r\n\t\t}\r\n\r\n\t\t.waterfall {\r\n\t\t\tmargin-top: 70px;\r\n\t\t\t/* 根据sticky区域的高度调整 */\r\n\t\t\tflex: 1;\r\n\r\n\t\t\t.swiper {\r\n\t\t\t\theight: 100%;\r\n\r\n\t\t\t\t.swiper-item {\r\n\t\t\t\t\theight: 100%;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t.waterfall-item {\r\n\t\t\t\tpadding: 6rpx;\r\n\t\t\t\tbox-sizing: border-box;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t.loadmore-container {\r\n\t\t\twidth: 100%;\r\n\t\t\tpadding: 20rpx 0;\r\n\t\t\tdisplay: flex;\r\n\t\t\tjustify-content: center;\r\n\t\t\talign-items: center;\r\n\t\t}\r\n\r\n\t\t.content {\r\n\t\t\tpadding: 12rpx;\r\n\r\n\t\t\t.title {\r\n\t\t\t\tfont-size: 28rpx;\r\n\t\t\t\tcolor: #333;\r\n\t\t\t\tfont-weight: 550;\r\n\t\t\t}\r\n\r\n\t\t\t.content-bottom {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tjustify-content: space-between;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tflex-direction: row;\r\n\t\t\t\tmargin-top: 12rpx;\r\n\r\n\t\t\t\t.content-bottom-left {\r\n\t\t\t\t\tdisplay: flex;\r\n\t\t\t\t\talign-items: center;\r\n\t\t\t\t\tfont-size: 22rpx;\r\n\t\t\t\t\tflex-direction: row;\r\n\t\t\t\t\tcolor: #606266;\r\n\r\n\t\t\t\t\t.nickname {\r\n\t\t\t\t\t\tmargin-left: 8rpx;\r\n\t\t\t\t\t\theight: 30rpx;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t.content-bottom-right {\r\n\t\t\t\t\tdisplay: flex;\r\n\t\t\t\t\talign-items: center;\r\n\t\t\t\t\tfont-size: 22rpx;\r\n\t\t\t\t\tflex-direction: row;\r\n\t\t\t\t\tcolor: #606266;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</style>","import Component from 'C:/Users/86150/Desktop/张亚冬项目/uniapp-project/pages/buy/components/buy.uvue'\nwx.createComponent(Component)"],"names":["ref","reactive","__awaiter","getHomeData","uni","getHomeWaterfallData","onMounted"],"mappings":"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"}